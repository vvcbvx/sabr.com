<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ØªØ¬Ø± Ù…Ø¶ÙŠÙ Ø§Ù„ÙˆØªØ¨Ù†</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --success-color: #27ae60;
            --danger-color: #e74c3c;
        }

        body {
            font-family: 'Tajawal', sans-serif;
            background: #f8f9fa;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            padding: 20px;
            background: var(--primary-color);
            color: white;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .logo {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 3px solid white;
        }

        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .btn {
            padding: 10px 25px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: 0.3s;
        }

        .btn-primary {
            background: var(--secondary-color);
            color: white;
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-danger {
            background: var(--danger-color);
            color: white;
        }

        .search-bar {
            width: 300px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
        }

        .product-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 3px 6px rgba(0,0,0,0.1);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .product-image {
            width: 100%;
            height: 200px;
            object-fit: contain;
            border-bottom: 2px solid #eee;
            padding-bottom: 15px;
        }

        .watermark {
            position: absolute;
            bottom: 10px;
            left: 10px;
            opacity: 0.1;
            font-size: 40px;
            font-weight: bold;
            color: var(--primary-color);
        }

        .cart-sidebar {
            position: fixed;
            left: 20px;
            top: 20px;
            background: white;
            padding: 20px;
            width: 320px;
            border-radius: 10px;
            box-shadow: 0 3px 6px rgba(0,0,0,0.1);
            z-index: 100;
        }

        .invoice-item {
            background: white;
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 8px;
            color: white;
            display: none;
            z-index: 1000;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }

        .notification.success { background: var(--success-color); }
        .notification.error { background: var(--danger-color); }
        .notification.info { background: var(--secondary-color); }

        .customer-management {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 3px 6px rgba(0,0,0,0.1);
        }

        .status {
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 14px;
            margin-top: 10px;
        }

        .status.available { background: var(--success-color); color: white; }
        .status.unavailable { background: var(--danger-color); color: white; }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header Section -->
        <div class="header">
            <img src="logo.png" class="logo" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ù…ØªØ¬Ø±">
            <h1>Ù…Ø¶ÙŠÙ Ø§Ù„ÙˆØªØ¨Ù†</h1>
            <p>Ù…ØªØ¬Ø±Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø§Ù„Ø¢Ù…Ù†</p>
        </div>

        <!-- Navigation -->
        <nav class="nav">
            <div>
                <button class="btn btn-primary" onclick="location.href='admin.html'">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</button>
                <button class="btn btn-primary" onclick="toggleSection('invoices')">Ø§Ù„ÙÙˆØ§ØªÙŠØ±</button>
                <button class="btn btn-primary" onclick="toggleSection('customers')">Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</button>
            </div>
            <input type="text" class="search-bar" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬..." oninput="searchProducts(event)">
        </nav>

        <!-- Cart Sidebar -->
        <div class="cart-sidebar">
            <h3>ğŸ›’ Ø³Ù„Ø© Ø§Ù„ØªØ³ÙˆÙ‚ (<span id="cartCount">0</span>)</h3>
            <div id="cartItems"></div>
            <hr>
            <h4>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: <span id="totalPrice">0</span> Ø±.Ø³</h4>
            <button class="btn btn-success" style="width:100%;" onclick="checkout()">Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø´Ø±Ø§Ø¡</button>
        </div>

        <!-- Invoices Section -->
        <div id="invoices" class="invoices-section" style="display:none;">
            <h2>Ø§Ù„ÙÙˆØ§ØªÙŠØ± Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©</h2>
            <div class="filters">
                <select id="dateFilter" onchange="filterInvoices()">
                    <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙÙˆØ§ØªÙŠØ±</option>
                    <option value="today">Ø§Ù„ÙŠÙˆÙ…</option>
                    <option value="week">Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</option>
                    <option value="month">Ø§Ù„Ø´Ù‡Ø±</option>
                </select>
            </div>
            <div id="invoicesList" class="invoices-list"></div>
        </div>

        <!-- Customers Section -->
        <div id="customers" class="customer-management" style="display:none;">
            <h2>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</h2>
            <div id="customersList"></div>
        </div>

        <!-- Products Grid -->
        <div class="products-grid" id="productsGrid"></div>

        <!-- Notifications -->
        <div id="notification" class="notification"></div>
    </div>

<script>
// Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
let products = JSON.parse(localStorage.getItem('products')) || [];
let cart = JSON.parse(localStorage.getItem('cart')) || [];
let invoices = JSON.parse(localStorage.getItem('invoices')) || [];
let customers = JSON.parse(localStorage.getItem('customers')) || [];

// Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù…
const BOT_TOKEN = '8119987442:AAEY-0a1zp6mtDtWPg0J8njLiovoXyXoZKo';
const CHAT_ID = '6068899411';

// ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
function showNotification(message, type = 'info') {
    const notification = document.getElementById('notification');
    notification.className = `notification ${type}`;
    notification.innerHTML = message;
    notification.style.display = 'block';
    setTimeout(() => { notification.style.display = 'none'; }, 5000);
}

function saveData() {
    localStorage.setItem('products', JSON.stringify(products));
    localStorage.setItem('cart', JSON.stringify(cart));
    localStorage.setItem('invoices', JSON.stringify(invoices));
    localStorage.setItem('customers', JSON.stringify(customers));
}

// Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¨Ø´ÙƒÙ„ Ø¹Ø´ÙˆØ§Ø¦ÙŠ
function renderProducts() {
    const grid = document.getElementById('productsGrid');
    const shuffledProducts = products.sort(() => Math.random() - 0.5); // ØªØ±ØªÙŠØ¨ Ø¹Ø´ÙˆØ§Ø¦ÙŠ
    grid.innerHTML = shuffledProducts.map(product => `
        <div class="product-card">
            <img src="${product.image}" class="product-image">
            <h3>${product.name}</h3>
            <p>${product.description}</p>
            <p class="price">${product.price} Ø±.Ø³</p>
            <div class="status ${product.status === 'available' ? 'available' : 'unavailable'}">
                ${product.status === 'available' ? 'Ù…ØªÙˆÙØ±' : 'ØºÙŠØ± Ù…ØªÙˆÙØ±'}
            </div>
            <button class="btn btn-primary" onclick="addToCart('${product.id}')">Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©</button>
         
        </div>
    `).join('');
}

// Ù†Ø¸Ø§Ù… Ø§Ù„Ø³Ù„Ø©
function updateCart() {
    document.getElementById('cartCount').textContent = cart.reduce((sum, item) => sum + item.quantity, 0);
    document.getElementById('totalPrice').textContent = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
    
    const cartItems = document.getElementById('cartItems');
    cartItems.innerHTML = cart.map(item => `
        <div class="cart-item">
            <div>
                <h4>${item.name}</h4>
                <p>${item.quantity} Ã— ${item.price} Ø±.Ø³</p>
            </div>
            <button class="btn btn-danger" onclick="removeFromCart('${item.id}')">Ø­Ø°Ù</button>
        </div>
    `).join('');
}

function addToCart(productId) {
    const product = products.find(p => p.id === productId);
    if (!product) return showNotification('Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 'error');
    if (product.status !== 'available') return showNotification('Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ØªÙˆÙØ±', 'error');

    const existing = cart.find(item => item.id === productId);
    
    if (existing) {
        existing.quantity++;
    } else {
        cart.push({...product, quantity: 1});
    }
    
    updateCart();
    saveData();
    showNotification('ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ù„Ù„Ø³Ù„Ø©', 'success');
}

function removeFromCart(productId) {
    cart = cart.filter(item => item.id !== productId);
    updateCart();
    saveData();
    showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬ Ù…Ù† Ø§Ù„Ø³Ù„Ø©', 'error');
}

// Ù†Ø¸Ø§Ù… Ø§Ù„ÙÙˆØ§ØªÙŠØ±
async function checkout() {
    if (cart.length === 0) return showNotification('Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©', 'error');
    
    const customerName = prompt('Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„:');
    if (!customerName) return;
    
    const invoice = {
        id: Date.now(),
        date: new Date().toLocaleString('ar-SA'),
        customer: customerName,
        items: [...cart],
        total: cart.reduce((sum, item) => sum + (item.price * item.quantity), 0)
    };
    
    // Ø­ÙØ¸ Ø§Ù„ÙØ§ØªÙˆØ±Ø©
    invoices.unshift(invoice);
    saveData();
    
    // Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù…
    const message = `ÙØ§ØªÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø© #${invoice.id}
Ø§Ù„Ø¹Ù…ÙŠÙ„: ${invoice.customer}
Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: ${invoice.total} Ø±.Ø³
Ø§Ù„ØªØ§Ø±ÙŠØ®: ${invoice.date}`;
    
    try {
        await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({
                chat_id: CHAT_ID,
                text: message
            })
        });
        showNotification('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ù„Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù…', 'success');
    } catch (error) {
        showNotification('ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙØ§ØªÙˆØ±Ø©', 'error');
    }
    
    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ø¸Ø§Ù…
    cart = [];
    updateCart();
    renderInvoices();
    showNotification('ØªÙ…Øª Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø´Ø±Ø§Ø¡ Ø¨Ù†Ø¬Ø§Ø­', 'success');
}

// Ø¹Ø±Ø¶ Ø§Ù„ÙÙˆØ§ØªÙŠØ±
function renderInvoices() {
    const invoicesList = document.getElementById('invoicesList');
    invoicesList.innerHTML = invoices.map(invoice => `
        <div class="invoice-item">
            <h4>Ø§Ù„ÙØ§ØªÙˆØ±Ø© #${invoice.id}</h4>
            <p>Ø§Ù„Ø¹Ù…ÙŠÙ„: ${invoice.customer}</p>
            <p>Ø§Ù„ØªØ§Ø±ÙŠØ®: ${invoice.date}</p>
            <p>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: ${invoice.total} Ø±.Ø³</p>
            <h5>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª:</h5>
            ${invoice.items.map(item => `
                <div class="invoice-product">
                    <p>${item.name} - ${item.quantity} Ã— ${item.price} Ø±.Ø³</p>
                </div>
            `).join('')}
        </div>
    `).join('');
}

// ØªØµÙÙŠØ© Ø§Ù„ÙÙˆØ§ØªÙŠØ± Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ®
function filterInvoices() {
    const filter = document.getElementById('dateFilter').value;
    const now = new Date();
    let filteredInvoices = [];

    switch (filter) {
        case 'today':
            filteredInvoices = invoices.filter(invoice => {
                const invoiceDate = new Date(invoice.date);
                return invoiceDate.toDateString() === now.toDateString();
            });
            break;
        case 'week':
            const startOfWeek = new Date(now.setDate(now.getDate() - now.getDay()));
            filteredInvoices = invoices.filter(invoice => new Date(invoice.date) >= startOfWeek);
            break;
        case 'month':
            const startOfMonth = new Date(now.getFullYear(), now.getMonth(), 1);
            filteredInvoices = invoices.filter(invoice => new Date(invoice.date) >= startOfMonth);
            break;
        default:
            filteredInvoices = invoices;
    }

    document.getElementById('invoicesList').innerHTML = filteredInvoices.map(invoice => `
        <div class="invoice-item">
            <h4>Ø§Ù„ÙØ§ØªÙˆØ±Ø© #${invoice.id}</h4>
            <p>Ø§Ù„Ø¹Ù…ÙŠÙ„: ${invoice.customer}</p>
            <p>Ø§Ù„ØªØ§Ø±ÙŠØ®: ${invoice.date}</p>
            <p>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: ${invoice.total} Ø±.Ø³</p>
            <h5>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª:</h5>
            ${invoice.items.map(item => `
                <div class="invoice-product">
                    <p>${item.name} - ${item.quantity} Ã— ${item.price} Ø±.Ø³</p>
                </div>
            `).join('')}
        </div>
    `).join('');
}

// ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
function toggleSection(sectionId) {
    const sections = ['invoices', 'customers'];
    sections.forEach(id => {
        const section = document.getElementById(id);
        if (id === sectionId) {
            section.style.display = section.style.display === 'none' ? 'block' : 'none';
            if (id === 'invoices') renderInvoices();
        } else {
            section.style.display = 'none';
        }
    });
}

// Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
function searchProducts(event) {
    const query = event.target.value.toLowerCase();
    const filteredProducts = products.filter(product => 
        product.name.toLowerCase().includes(query) ||
        product.description.toLowerCase().includes(query)
    );
    renderFilteredProducts(filteredProducts);
}

function renderFilteredProducts(filteredProducts) {
    const grid = document.getElementById('productsGrid');
    grid.innerHTML = filteredProducts.map(product => `
        <div class="product-card">
            <img src="${product.image}" class="product-image">
            <h3>${product.name}</h3>
            <p>${product.description}</p>
            <p class="price">${product.price} Ø±.Ø³</p>
            <div class="status ${product.status === 'available' ? 'available' : 'unavailable'}">
                ${product.status === 'available' ? 'Ù…ØªÙˆÙØ±' : 'ØºÙŠØ± Ù…ØªÙˆÙØ±'}
            </div>
            <button class="btn btn-primary" onclick="addToCart('${product.id}')">Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©</button>
         
          
          </div>
    `).join('');
}

// Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø£ÙˆÙ„ÙŠØ©
function init() {
    renderProducts();
    updateCart();
    showNotification('Ù…Ø±Ø­Ø¨Ø§ Ø¨Ùƒ ÙÙŠ Ù…ØªØ¬Ø± Ù…Ø¶ÙŠÙ Ø§Ù„ÙˆØªØ¨Ù†!', 'info');
}

window.onload = init;
</script>
</body>
</html>